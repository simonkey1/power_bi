[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "âš¡ AnÃ¡lisis en Tiempo Real del Suministro ElÃ©ctrico de Chile âš¡",
    "section": "",
    "text": "Hace poco descubrÃ­ la pÃ¡gina de la Superintendecia de Electricidad y Combustibles (SEC). Me llamÃ³ la atenciÃ³n en particular su secciÃ³n de mÃ©tricas e informaciÃ³n de los cortes de luz a nivel nacional, debido a que notÃ© que hay un gran margen de mejora en su accesibilidad y visualizaciÃ³n de los datos para el usuario."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n\nCode\n1 + 1\n\n\n[1] 2"
  },
  {
    "objectID": "index.html#introducciÃ³n",
    "href": "index.html#introducciÃ³n",
    "title": "âš¡ AnÃ¡lisis en Tiempo Real del Suministro ElÃ©ctrico de Chile âš¡",
    "section": "",
    "text": "Hace poco descubrÃ­ la pÃ¡gina de la Superintendecia de Electricidad y Combustibles (SEC). Me llamÃ³ la atenciÃ³n en particular su secciÃ³n de mÃ©tricas e informaciÃ³n de los cortes de luz a nivel nacional, debido a que notÃ© que hay un gran margen de mejora en su accesibilidad y visualizaciÃ³n de los datos para el usuario."
  },
  {
    "objectID": "index.html#quÃ©-haremos",
    "href": "index.html#quÃ©-haremos",
    "title": "âš¡ AnÃ¡lisis en Tiempo Real del Suministro ElÃ©ctrico de Chile âš¡",
    "section": "Â¿QuÃ© haremos?",
    "text": "Â¿QuÃ© haremos?\n\nPreparar nuestro entorno: primero, instalaremos las dependencias necesarias para el proyecto.\nExtracciÃ³n de los datos: aprenderemos a realizar web scraping con Playwright.\nTransformaciÃ³n de los datos: necesitaremos limpiar y procesar los datos extraÃ­dos con Pandas.\nVisualizaciÃ³n de los datos: finalmente, visualizaremos los datos en Powerbi."
  },
  {
    "objectID": "index.html#entorno-de-desarrollo",
    "href": "index.html#entorno-de-desarrollo",
    "title": "âš¡ AnÃ¡lisis en Tiempo Real del Suministro ElÃ©ctrico de Chile âš¡",
    "section": "Entorno de Desarrollo",
    "text": "Entorno de Desarrollo\nPara este proyecto, necesitaremos instalar las siguientes dependencias: Playwright, Pandas y Powerbi.\nLes recomiendo crear un entorno virtual para instalar las dependencias. Para ello, decidan un directorio donde quieran crear el entorno virtual y ejecuten el siguiente comando en la terminal:\n\n python -m venv \"nombre-del-entorno\"-env\nUna vez creado el entorno virtual, actÃ­venlo con el siguiente comando:\n\nsource \"nombre-del-entorno\"-env/bin/activate\nAhora, instalemos las dependencias necesarias:\n\n    pip install playwright pandas"
  },
  {
    "objectID": "index.html#extracciÃ³n-de-los-datos",
    "href": "index.html#extracciÃ³n-de-los-datos",
    "title": "âš¡ AnÃ¡lisis en Tiempo Real del Suministro ElÃ©ctrico de Chile âš¡",
    "section": "ExtracciÃ³n de los Datos",
    "text": "ExtracciÃ³n de los Datos\nPrimero, necesitamos importar las librerÃ­as necesarias:\n\n    from playwright.sync_api import sync_playwright\n    import pandas as pd\nUna vez creado el entorno virtual, actÃ­valo:\nbash\nsource â€œnombre-del-entornoâ€-env/bin/activate"
  },
  {
    "objectID": "index.html#extracciÃ³n-de-datos-con-playwright",
    "href": "index.html#extracciÃ³n-de-datos-con-playwright",
    "title": "âš¡ AnÃ¡lisis en Tiempo Real del Suministro ElÃ©ctrico de Chile âš¡",
    "section": "ğŸ” ExtracciÃ³n de Datos con Playwright",
    "text": "ğŸ” ExtracciÃ³n de Datos con Playwright\nUsaremos Playwright para interceptar las respuestas de la API de la SEC.\n\nğŸ“Œ ImportaciÃ³n de LibrerÃ­as\nfrom playwright.sync_api import sync_playwright\nimport pandas as pd\nimport os\nimport time\nimport re\nfrom datetime import datetime, timedelta"
  },
  {
    "objectID": "index.html#definiciÃ³n-de-archivos-de-salida",
    "href": "index.html#definiciÃ³n-de-archivos-de-salida",
    "title": "âš¡ AnÃ¡lisis en Tiempo Real del Suministro ElÃ©ctrico de Chile âš¡",
    "section": "ğŸ“‚ DefiniciÃ³n de Archivos de Salida",
    "text": "ğŸ“‚ DefiniciÃ³n de Archivos de Salida\nGuardaremos los datos en dos archivos CSV:\n\nclientes_afectados_tiempo_real.csv: Contiene los datos mÃ¡s recientes.\nclientes_afectados_historico.csv: Mantiene un registro histÃ³rico.\n\ncsv_tiempo_real = \"clientes_afectados_tiempo_real.csv\"\ncsv_historico = \"clientes_afectados_historico.csv\""
  },
  {
    "objectID": "index.html#estructura-general",
    "href": "index.html#estructura-general",
    "title": "âš¡ AnÃ¡lisis en Tiempo Real del Suministro ElÃ©ctrico de Chile âš¡",
    "section": "ğŸ“Œ Estructura General",
    "text": "ğŸ“Œ Estructura General\n\nAbrir un navegador en modo headless (sin interfaz grÃ¡fica).\nInterceptar las respuestas de la API en la pÃ¡gina de la SEC.\nExtraer informaciÃ³n clave de los datos JSON recibidos.\nProcesar los datos para calcular tiempos y crear identificadores Ãºnicos.\nGuardar la informaciÃ³n en archivos CSV.\nCerrar el navegador una vez completado el proceso."
  },
  {
    "objectID": "index.html#paso-a-paso-de-la-funciÃ³n",
    "href": "index.html#paso-a-paso-de-la-funciÃ³n",
    "title": "âš¡ AnÃ¡lisis en Tiempo Real del Suministro ElÃ©ctrico de Chile âš¡",
    "section": "ğŸ›  Paso a Paso de la FunciÃ³n",
    "text": "ğŸ›  Paso a Paso de la FunciÃ³n\n\n1ï¸âƒ£ Inicializar Playwright y Abrir el Navegador\nSe utiliza sync_playwright() para iniciar Playwright y lanzar un navegador Chromium en modo headless (sin interfaz grÃ¡fica).\nwith sync_playwright() as p:\n    browser = p.chromium.launch(headless=True)  # Lanzar navegador en modo headless\n    page = browser.new_page()\nğŸ“Œ Â¿QuÃ© hace esto?\n\nCrea una instancia de Playwright.\nLanza un navegador Chromium sin interfaz visual.\nCrea una nueva pÃ¡gina en ese navegador.\n\n\n\n\n2ï¸âƒ£ Definir una Lista para Almacenar Registros\nregistros = []  # Lista para almacenar datos nuevos\nğŸ“Œ Â¿Para quÃ© sirve?\n\nAquÃ­ se guardarÃ¡n los datos extraÃ­dos de la API antes de escribirlos en los archivos CSV.\n\n\n\n\n3ï¸âƒ£ Interceptar las Respuestas de la API\ndef handle_response(response):\n    if \"GetPorFecha\" in response.url:\n        try:\n            data = response.json()\n            timestamp_actual = datetime.now()  # Tiempo de consulta\nğŸ“Œ Â¿QuÃ© hace esto?\n\nVerifica si la URL de la respuesta contiene \"GetPorFecha\", lo que indica que es una respuesta de la API relevante.\nConvierte la respuesta en JSON (response.json()).\nGuarda el timestamp actual para identificar cuÃ¡ndo se hizo la consulta.\n\n\n\n\n4ï¸âƒ£ Procesar los Datos ExtraÃ­dos\nfor entry in data:\n    actualizado_hace = entry.get(\"ACTUALIZADO_HACE\", \"\")\n    minutos_atras = 0\n\n    match = re.search(r'(\\d+)\\s+Minutos', actualizado_hace)\n    if match:\n        minutos_atras = int(match.group(1))  # Extrae el nÃºmero antes de \"Minutos\"\n\n    hora_exacta_reporte = timestamp_actual - timedelta(minutes=minutos_atras)\nğŸ“Œ Â¿QuÃ© hace esto?\n\nExtrae el campo \"ACTUALIZADO_HACE\", que indica hace cuÃ¡nto tiempo se actualizÃ³ la informaciÃ³n.\nUsa una expresiÃ³n regular (re.search) para extraer los minutos mencionados en \"ACTUALIZADO_HACE\".\nCalcula la hora exacta del reporte, restando esos minutos del timestamp actual.\n\n\n\n\n5ï¸âƒ£ Crear un Identificador Ãšnico para Cada Registro\nunique_id = f\"{entry.get('FECHA_INT_STR', '')}-{entry.get('REGION', '')}-{entry.get('COMUNA', '')}-{entry.get('EMPRESA', '')}-{entry.get('CLIENTES_AFECTADOS', 0)}-{hora_exacta_reporte.strftime('%Y-%m-%d %H:%M:%S')}\"\nğŸ“Œ Â¿Por quÃ© es importante esto?\n\nEvita la duplicaciÃ³n de datos, asegurando que cada registro tenga un ID Ãºnico.\nFacilita la organizaciÃ³n en los archivos CSV.\n\n\n\n\n6ï¸âƒ£ Guardar los Datos en la Lista registros\nregistros.append({\n    \"ID_UNICO\": unique_id,\n    \"TIMESTAMP\": timestamp_actual.strftime(\"%Y-%m-%d %H:%M:%S\"),\n    \"HORA_EXACTA_REPORTE\": hora_exacta_reporte.strftime(\"%Y-%m-%d %H:%M:%S\"),\n    \"FECHA\": entry.get(\"FECHA_INT_STR\", \"\"),\n    \"REGION\": entry.get(\"NOMBRE_REGION\", \"\"),\n    \"COMUNA\": entry.get(\"NOMBRE_COMUNA\", \"\"),\n    \"EMPRESA\": entry.get(\"NOMBRE_EMPRESA\", \"\"),\n    \"CLIENTES_AFECTADOS\": entry.get(\"CLIENTES_AFECTADOS\", 0),\n    \"ACTUALIZADO_HACE\": actualizado_hace\n})\nğŸ“Œ Â¿QuÃ© hace esto?\n\nGuarda cada registro como un diccionario dentro de la lista registros.\nAlmacena los datos clave como fecha, regiÃ³n, comuna, empresa y clientes afectados.\n\n\n\n\n7ï¸âƒ£ Capturar las Respuestas de la API\npage.on(\"response\", handle_response)\nğŸ“Œ Â¿QuÃ© hace esto?\n\nAsocia la funciÃ³n handle_response con cada respuesta de la pÃ¡gina.\nIntercepta las respuestas en segundo plano mientras se carga la web.\n\n\n\n\n8ï¸âƒ£ Acceder a la PÃ¡gina de la SEC\npage.goto(\"https://apps.sec.cl/INTONLINEv1/index.aspx\")\npage.wait_for_timeout(5000)  # Espera para capturar datos\nğŸ“Œ Â¿QuÃ© hace esto?\n\nAbre la pÃ¡gina de la SEC en el navegador.\nEspera 5 segundos para permitir la carga de datos.\n\n\n\n\n9ï¸âƒ£ Cerrar el Navegador\nbrowser.close()\nğŸ“Œ Â¿Por quÃ© es importante?\n\nLibera recursos del sistema.\nEvita que el script consuma demasiada memoria."
  },
  {
    "objectID": "index.html#guardado-de-datos-en-csv",
    "href": "index.html#guardado-de-datos-en-csv",
    "title": "âš¡ AnÃ¡lisis en Tiempo Real del Suministro ElÃ©ctrico de Chile âš¡",
    "section": "ğŸ“Š Guardado de Datos en CSV",
    "text": "ğŸ“Š Guardado de Datos en CSV\nif registros:\n    df_new = pd.DataFrame(registros)\n\n    # ğŸ“Œ Guardar en CSV histÃ³rico\n    if os.path.exists(csv_historico):\n        df_historico = pd.read_csv(csv_historico, encoding=\"utf-8-sig\")\n        df_historico = pd.concat([df_historico, df_new]).drop_duplicates(subset=[\"ID_UNICO\"], keep=\"first\")\n    else:\n        df_historico = df_new\n\n    df_historico.to_csv(csv_historico, index=False, encoding=\"utf-8-sig\")\n\n    # ğŸ“Œ Guardar en CSV de Tiempo Real\n    df_new.to_csv(csv_tiempo_real, index=False, encoding=\"utf-8-sig\")\n\n    print(f\"âœ… Datos guardados en:\\nğŸ“Œ {csv_historico} (HistÃ³rico)\\nğŸ“Œ {csv_tiempo_real} (Tiempo Real)\")\nğŸ“Œ Â¿QuÃ© hace esto?\n\nConvierte los registros en un DataFrame de Pandas.\nGuarda los datos en CSV histÃ³rico y de tiempo real.\nEvita duplicados basÃ¡ndose en el ID Ãºnico."
  },
  {
    "objectID": "index.html#automatizaciÃ³n-cada-5-minutos",
    "href": "index.html#automatizaciÃ³n-cada-5-minutos",
    "title": "âš¡ AnÃ¡lisis en Tiempo Real del Suministro ElÃ©ctrico de Chile âš¡",
    "section": "ğŸ” AutomatizaciÃ³n Cada 5 Minutos",
    "text": "ğŸ” AutomatizaciÃ³n Cada 5 Minutos\nwhile True:\n    intercept_responses()\n    print(\"â³ Esperando 5 minutos para la siguiente ejecuciÃ³n...\\n\")\n    time.sleep(5 * 60)  # 5 minutos en segundos\nğŸ“Œ Â¿QuÃ© hace esto?\n\nEjecuta intercept_responses() en un bucle infinito.\nEspera 5 minutos (time.sleep(5 * 60)) antes de volver a ejecutar la funciÃ³n."
  }
]